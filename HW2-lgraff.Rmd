---
title: "HW2-lgraff"
author: "Lindsay Graff"
date: "October 4, 2019"
output: html_document
---

```{r setup, include=FALSE}
require(rgdal)
require(leaflet)
require(leaflet.extras)

require(dplyr)
require(readxl)
require(stringr)

require(raptr)
require(PBSmapping)
```

## Load shapefile

```{r }
FL_counties <- readOGR("FL_eviction_counties.geojson")
plot(FL_counties)

# Select a subset of columns
FL_16 <- FL_counties
FL_16@data <- FL_16@data %>% 
  select(GEOID, west, south, north, n, pl, pr.16, mgr.16, mpv.16, e.16, er.16)
```

## Basemap

```{r basemap}
leaflet() %>%
  addProviderTiles(providers$OpenStreetMap)  

  #addPolygons(data = FL_16, weight = 1)
```

```{r points}

# Calculate centroids of counties to find lat and long
FL_polyset <- SpatialPolygons2PolySet(x = FL_16)
head(latlong)
centroid <- calcCentroid(FL_polyset, rollup = 1)

# Bind county centroids to Florida data
df_FL <- cbind(FL_16@data, centroid)

# Map with circle markers, radius defined by median gross rent2
leaflet() %>%
  addProviderTiles(providers$OpenStreetMap) %>% 
  addPolygons(data = FL_16, weight = 1) %>% 
  addCircleMarkers(data = df_FL, lat = ~Y, lng = ~X, 
                   radius = ~(mgr.16)^(.15),
                   popup = ~mgr.16,
                   color = "red") 

```

```{r lines}

# Map with layer of lines
leaflet() %>% 
  addProviderTiles(providers$OpenStreetMap) %>% 
  addPolylines(data = FL_16, weight = 1) 
  
```

# Add polygons colored by median gross rent
```{r polygons}
# Make color palette for median gross rent (mgr)
bins <- c(500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400)
pal <- colorBin("YlOrRd", domain = df_FL$mgr.16, bins = bins)

# Map with layer of polygons, colored by mgr
leaflet() %>% 
  addProviderTiles(providers$OpenStreetMap) %>% 
  addPolygons(data = FL_16, weight = 1,
              fillColor = ~pal(mgr.16),
              fillOpacity = 0.8)

```



## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
